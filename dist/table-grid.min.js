angular.module("table.grid",["angularUtils.directives.dirPagination","ui.bootstrap"]).constant("tableConfig",{defaultFilter:"",defaultLimit:5,defaultOrder:"-_id",defaultActions:["view","edit","remove"],enableButtons:!0,appLabels:{status:{0:{name:"Inativo",class:"default",icon:"ban-circle"},1:{name:"Ativo",class:"success",icon:"ok-circle"}}},url:"",authentication:null}).filter("round",function(){return function(e,n){return n=void 0==n?"ceil":n,"NaN"==String(e)?1:Math[n](e)}}).directive("tableGrid",function(){return{restrict:"E",templateUrl:"table-grid.html",scope:{model:"=model",fields:"=fields",actions:"=?actions",filter:"=?filter",limit:"=?limit",moduleName:"=?moduleName",showBreadcrumb:"=?showBreadcrumb",isOwner:"@isOwner",searchOptions:"=?searchOptions",order:"@order"},controller:["$scope","$location","$filter","tableConfig",function(e,n,t,i){if(void 0==e.model||void 0==e.fields)throw"the configuration base is not informed!";e.currentPage=1,e.moduleName=e.moduleName||n.$$path.replace("/",""),e.showBreadcrumb=void 0==e.showBreadcrumb||e.showBreadcrumb,e.isOwner=void 0!=e.isOwner&&e.isOwner,e.order=e.order||i.defaultOrder,e.limit=e.limit||i.defaultLimit,e.filter=e.filter||i.defaultFilter,e.actions=e.actions||i.defaultActions,e.addFilter=function(e,n,i){return 2==i.length?t(i[0])(this.renderLine(e,n),i[1]):"-"},e.renderLine=function(e,n,t){return void 0!==n.fk?void 0!=e[n.fk]&&void 0!=e[n.fk][n.column]?e[n.fk][n.column]:"-":e[n.column]||"-"}}]}}).directive("paginateSearchGrid",function(){return{restrict:"E",templateUrl:"search-grid.html",scope:{moduleName:"=moduleName",limit:"=?limit",filter:"=?filter",withCreate:"=?withCreate",withSearch:"=?withSearch"},controller:["$scope","$location","paginationService","$timeout","tableConfig",function(e,n,t,i,r){e.totalItems=0,e.currentPage=1,e.withSearch=void 0==e.withSearch||e.withSearch,e.withCreate=void 0==e.withCreate||e.withCreate,e.limit=e.limit||r.defaultLimit,e.filter=e.filter||r.defaultFilter,e.changePage=function(n){e.currentPage=n},e.listen=function(){i(function(){var n=t.getLastInstanceId();null!=n?e.totalItems=t.getCollectionLength(n):e.listen()},100)},e.listen(),e.createUrl=function(t){return t=void 0==t?"create":t,1==r.enableButtons?"/#!/"+e.moduleName+"/"+t:"/#!"+n.$$path}}]}}).directive("headerGrid",function(){return{restrict:"E",templateUrl:"header-grid.html",scope:{lines:"=?lines"},controller:["$scope","$location",function(e,n){e.lines=e.lines||[],e.lines.length>0&&(e.lines.reverse(),e.lines[0].path=!1,e.lines.reverse())}]}}).directive("labelItem",function(){return{restrict:"E",templateUrl:"label-grid.html",scope:{hasIcon:"=?hasIcon",index:"=?index",item:"@item",addIndex:"@addIndex"},controller:["$scope","tableConfig",function(e,n){e.hasIcon=void 0==e.hasIcon||e.hasIcon;var t=n.appLabels[e.item];void 0!=t&&void 0!=t[e.index]&&(e.data=t[e.index],void 0!=e.data&&"object"==typeof e.data.name&&void 0!=e.addIndex&&(e.data.name=e.data.name[e.addIndex]))}]}}).directive("tableAction",function(){return{restrict:"E",templateUrl:"table-action.html",scope:{module:"=module"},controller:["$scope","tableConfig","$location",function(e,n,t){e.delete=function(n){if("function"!=typeof e.$root.delete)throw"The current controller no have 'delete' method";e.$root.delete(n)},e.createUrl=function(i){return 1==n.enableButtons?"/#!/"+e.module.name+"/"+e.module.id+"/"+i:"/#!"+t.$$path}}]}}),angular.module("table.grid").run(["$templateCache",function(e){e.put("header-grid.html",'<ul class="breadcrumb">\r\n    <li><a ng-href="/#!/">Home</a></li>\r\n    <li ng-repeat="row in lines">\r\n        <a ng-href="/#!/{{row.path}}" data-ng-show="row.path !== false">\r\n            <span data-ng-bind="row.label"></span>\r\n        </a>\r\n        <span data-ng-bind="row.label" data-ng-show="row.path===false"></span>\r\n    </li>\r\n</ul>'),e.put("label-grid.html",'<div class="label label-{{data.class}}" uib-tooltip="{{item}} : {{data.name}}" uib-tooltip-placement="top" uib-tooltip-trigger="mouseenter">\r\n    <span ng-show="hasIcon" class="glyphicon glyphicon-{{data.icon}}"></span>\r\n    <span ng-bind="data.name"></span>\r\n</div>'),e.put("search-grid.html",'<div class="template-head">\r\n    <div class="col-md-4">\r\n        <div ng-show="totalItems > limit">\r\n            <div class="text-right">\r\n                <dir-pagination-controls max-size="4" boundary-links="true" on-page-change="changePage(newPageNumber)"></dir-pagination-controls>\r\n            </div>\r\n        </div>\r\n        <div ng-if="totalItems == 0 && (filter != null && filter != \'\')">\r\n            <span class="glyphicon glyphicon-info-sign"></span>\r\n            Nenhum resultado encontrado para <strong>\'{{filter}}\'</strong>\r\n        </div>\r\n    </div>\r\n    <div class="col-md-8" ng-if="withSearch">\r\n        <div class="input-group">    \r\n            <div class="input-group-btn">\r\n                <a ng-href class="btn btn-default" style="cursor: move">\r\n                    <i ng-bind="currentPage+\'/\'+(totalItems/limit | round)+\' - \'+totalItems"></i>\r\n                </a>\r\n            </div>\r\n            <input type="text" ng-model="$parent.filter" ng-change="listen()" class="form-control" placeholder="procure por um registro...">\r\n            <div class="input-group-btn" ng-show="withCreate==true">\r\n                <a ng-href="{{createUrl()}}" class="btn btn-primary">\r\n                    <span class="glyphicon glyphicon-plus"></span>\r\n                    Novo\r\n                </a>\r\n            </div>    \r\n        </div>\r\n    </div>\r\n    <div class="clear"></div>\r\n</div>'),e.put("table-action.html",'<div ng-if="module.actions.length>0">\n    <a ng-if="module.actions.indexOf(\'view\') != -1" ng-href="{{createUrl(\'view\')}}" class="no-underline label label-warning"\n       tooltip="Visualizar" tooltip-placement="top" tooltip-trigger="mouseenter">\n        <span class="glyphicon glyphicon-eye-open"></span>\n    </a>\n    <a ng-if="module.actions.indexOf(\'edit\') != -1" ng-href="{{createUrl(\'edit\')}}" class="no-underline label label-primary"\n       tooltip="Editar" tooltip-placement="top" tooltip-trigger="mouseenter">\n        <span class="glyphicon glyphicon-edit"></span>\n    </a>\n    <a ng-if="module.actions.indexOf(\'remove\') != -1" ng-href role="button" ng-click="delete(module.id)" class="no-underline label label-danger"\n       tooltip="Remover" tooltip-placement="top" tooltip-trigger="mouseenter">\n        <span class="glyphicon glyphicon-remove"></span>\n    </a>\n</div>'),e.put("table-grid.html",'\x3c!--Block with breadcrumb--\x3e\r\n<header-grid ng-if="showBreadcrumb==true" lines="$parent.$parent.lines"></header-grid>\r\n\r\n\x3c!--Block with pagination, search and add button--\x3e\r\n<paginate-search-grid filter="filter" limit="limit" with-search="searchOptions.withSearch" with-create="searchOptions.withCreate" module-name="moduleName"></paginate-search-grid>\r\n\r\n\x3c!--Block with table template default--\x3e\r\n<table class="table table-striped table-bordered table-hover content table-responsive">\r\n    <thead>\r\n        <tr>\r\n            <th ng-repeat="f in fields">{{f.label}}</th>\r\n            <th>Ações</th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <tr dir-paginate="model in model | orderBy: order | filter: filter | itemsPerPage: limit" current-page="currentPage">\r\n            <td ng-repeat="f in fields">\r\n                <div ng-if="f.type==\'simple\'" ng-bind="renderLine(model, f)"></div>\r\n\r\n                <div ng-if="f.type==\'filter\'">\r\n                    <span ng-bind="addFilter(model, f, f.filter)"></span>\r\n                </div>\r\n\r\n                <div ng-if="f.type==\'link\' && f.url !=\'undefined\'">\r\n                    <a ng-href="{{f.url==\'view\' ? \'/#!/\'+moduleName+\'/\'+model._id : f.url }}" ng-bind="renderLine(model, f)"></a>\r\n                </div>\r\n\r\n                <div ng-if="f.type==\'image\'">\r\n                    \x3c!---image-s3 url="renderLine(model, f)" path="f.pathImage" with-user-id="{{f.userId}}" alt="imagem" class="image-thumb-4"></image-s3--\x3e\r\n                </div>\r\n\r\n                <div ng-if="f.type==\'template\'">\r\n                    <label-item has-icon="f.icon" item="{{f.column}}" index="model[f.column]"></label-item>\r\n                </div>\r\n            </td>\r\n            <td align="center">\r\n                <div ng-if="!isOwner">\r\n                    <table-action module="{id: model._id, name: moduleName, actions: actions}"></table-action>\r\n                </div>\r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n</table>')}]);